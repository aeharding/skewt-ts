"use strict";function _typeof(e){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}(function(){'use strict';var N=Math.tan,en=Math.PI,tn=Math.abs,nn=Math.atan,ea=Math.sqrt,ta=Math.LN10,na=Math.ceil,aa=Math.floor,ra=Math.round,ia=Math.log10,la=Math.pow,oa=Math.exp,sa=Math.log,da=Math.min,pa=Math.max;function ca(e,t,n,a,r){if(e==n)return t;var l=(r-e)/(n-e);return Array.isArray(t)?t.map(function(e,t){return e*(1-l)+a[t]*l}):t*(1-l)+a*l}function ua(e,t,n){var a=e[0]>e[1];return n.map(function(n){var r=e.findIndex(function(e){return a?e<=n:e>=n});return-1==r?r=e.length-1:0==r&&(r=1),ca(e[r-1],t[r-1],e[r],t[r],n)})}function ha(e,t,n,a){for(var r=Math.sign,i=pa(e[0],n[0]),l=da(e[e.length-1],n[n.length-1]),o=Array.from(new Set([].concat(_toConsumableArray(e),_toConsumableArray(n)))).filter(function(e){return e>=i&&e<=l}).sort(function(e,t){return+e>+t?1:-1}),s=ua(e,t,o),d=ua(n,a,o),p=0;p<o.length-1;p++){var c=s[p],u=d[p],h=o[p];if(c==u)return[h,c];var g=s[p+1],m=d[p+1];if(r(u-c)!=r(m-g)){var f=o[p+1],y=f-h,_=(g-c)/y,v=(u-c)/(_-(m-u)/y);return[h+v,c+v*_]}}return null}function ga(e,t){return e.map(function(e,n){return[e,t[n]]})}function ma(e,t){e=e.map(Math.log);var n=function(n){return ua(e,t,[sa(n)])[0]};return n.invert=function(n){return oa(ua(t,e,[n])[0])},n}function fa(e,t,n){return t*la(e/n,287/1005)}function ya(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Cr;return n*e/(t-e)}function _a(e,t){return ya(va(t),e)}function va(e){var t=e-Lr;return Sr*oa(17.67*t/(t+243.5))}function xa(e,t){var n=_a(e,t),a=1005+la(2501000,2)*n*Cr/(287*la(t,2));return 1/e*((287*t+2501000*n)/a)}function ba(e,t){return e*t/(Cr+t)}function wa(e){var t=sa(e/Sr);return Lr+243.5*t/(17.67-t)}function ka(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1013.25;return 288.15/Pr*(la(e/t,-Pr*287/zr)-1)}function Ta(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1013.25;return t*=3.28084,la(-(t/145366.45-1),1/.190284)*n}function Ca(e,t,n,a,r){for(var i,l=0;l<e.temp.length;l++){for(var o in i=!1,e)e[o][l]||0===e[o][l]||(i=!0);if(i)for(var s in e)e[s].splice(l,1)}for(var d={},p=[],c=[],u=[],h=[],g=[],m=ya(va(r),a),f=ma(e.level,e.gh),y=f(a),_=pa(y,e.gh[e.gh.length-1]),v=(_-y)/t,x=function(n,a){for(var r,i=[],l=[],o=[],s=f.invert(n);n<_+v;n+=v)r=f.invert(n),a+=(r-s)*xa(r,a),s=r,i.push(n),l.push(r),o.push(a);var d,p,c=ga(o,l),u=ha(i,o,e.gh,e.temp);return u?(d=u[0],p=f.invert(u[0]),c=c.filter(function(e){return e[1]>=p}),c.push([u[1],p])):(d=1e5,p=f.invert(d)),{moist:c,cloudTop:d,pCloudTop:p}},b=y;b<=_;b+=v){var w=f.invert(b),k=fa(w,n,a),T=wa(ba(w,m));p.push(b),c.push(w),u.push(k),h.push(T);var C=fa(w,e.temp[0],a);g.push(C)}var S=ha(p,u,p,h),A=ha(p,u,e.gh,e.temp),E=ha(p,g,p,h),P=ha(p,h,e.gh,e.temp);if(E&&E.length){d.LCL=E[0];var N=f.invert(E[0]);d.isohumeToDry=[].concat(ga(g,c).filter(function(e){return e[1]>=N}),[[E[1],N]],ga(h,c).filter(function(e){return e[1]>=N}).reverse())}if(P&&P.length){var z=f.invert(P[0]);d.TCON=fa(a,P[1],z);for(var D,O=[-Infinity];O[0]<P[0];d.TCON+=.5){D=[];for(var M,R=y;R<=_;R+=v)M=fa(f.invert(R),d.TCON,a),D.push(M);O=ha(p,D,e.gh,e.temp)}d.TCON-=.5,O[0]>P[0]&&(P=ha(p,D,p,h)),d.CCL=P[0],z=f.invert(P[0]),d.isohumeToTemp=[].concat(ga(h,c).filter(function(e){return e[1]>=z}),[[P[1],z]],ga(D,c).filter(function(e){return e[1]>=z}).reverse()),d.moistFromCCL=x(P[0],P[1]).moist}if(d.surface=e.gh[0],!A)return d;if(d.origThermalTop=A[0],A&&S&&S[0]<A[0]){A=S;var j=f.invert(S[0]);Object.assign(d,x(S[0],S[1]));var X=ga(h,c).filter(function(e){return e[1]>j});X.push([S[1],j]),d.isohume=X}var q=f.invert(A[0]),I=ga(u,c).filter(function(e){return e[1]>q});return I.push([A[1],q]),d.dry=I,d.pThermalTop=q,d.elevThermalTop=A[0],d}function Sa(e,t,n){return e+n*(t-e)}function Aa(e,t){return 0>e?0:e>t-1?t-1:e}function La(e){return g[aa(Aa(e,160))]}function Ea(e,t,n,a,r){return(.5*-e+.5*(3*t)-.5*(3*n)+.5*a)*la(r,3)+(e-.5*(5*t)+2*n-.5*a)*la(r,2)+(.5*-e+.5*n)*r+t}function Pa(e,n,a){return Ea(Ea(e[0],e[1],e[2],e[3],n),Ea(e[4],e[5],e[6],e[7],n),Ea(e[8],e[9],e[10],e[11],n),Ea(e[12],e[13],e[14],e[15],n),a)}function Na(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(a){var n;return 1===a.length&&(n=a,a=function(e,t){return Na(n(e),t)}),{left:function(t,n,e,l){for(null==e&&(e=0),null==l&&(l=t.length);e<l;){var s=e+l>>>1;0>a(t[s],n)?e=s+1:l=s}return e},right:function(t,n,e,l){for(null==e&&(e=0),null==l&&(l=t.length);e<l;){var s=e+l>>>1;0<a(t[s],n)?l=s:e=s+1}return e}}}function za(l,s,d){var p,c,h,g,m=-1;if(d=+d,(l=+l)==(s=+s)&&0<d)return[l];if((p=s<l)&&(c=l,l=s,s=c),0===(g=Da(l,s,d))||!isFinite(g))return[];if(0<g)for(l=na(l/g),s=aa(s/g),h=Array(c=na(s-l+1));++m<c;)h[m]=(l+m)*g;else for(l=aa(l*g),s=na(s*g),h=Array(c=na(l-s+1));++m<c;)h[m]=(l-m)/g;return p&&h.reverse(),h}function Da(l,t,n){var e=(t-l)/pa(0,n),r=aa(sa(e)/ta),i=e/la(10,r);return 0<=r?(i>=jr?10:i>=o?5:i>=a?2:1)*la(10,r):-la(10,-r)/(i>=jr?10:i>=o?5:i>=a?2:1)}function Oa(e){return e}function h(e){return"translate("+(e+.5)+",0)"}function p(e){return"translate(0,"+(e+.5)+")"}function Ma(e){return function(t){return+e(t)}}function Ra(a){var t=pa(0,a.bandwidth()-1)/2;return a.round()&&(t=ra(t)),function(n){return+a(n)+t}}function v(){return!this.__axis}function e(g,m){function d(e){var n=null==C?m.ticks?m.ticks.apply(m,f):m.domain():C,a=null==z?m.tickFormat?m.tickFormat.apply(m,f):Oa:z,r=pa(D,0)+R,i=m.range(),o=+i[0]+.5,d=+i[i.length-1]+.5,p=(m.bandwidth?Ra:Ma)(m.copy()),c=e.selection?e.selection():e,u=c.selectAll(".domain").data([null]),h=c.selectAll(".tick").data(n,m).order(),y=h.exit(),_=h.enter().append("g").attr("class","tick"),x=h.select("line"),b=h.select("text");u=u.merge(u.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),h=h.merge(_),x=x.merge(_.append("line").attr("stroke","currentColor").attr(s+"2",t*D)),b=b.merge(_.append("text").attr("fill","currentColor").attr(s,t*r).attr("dy",1===g?"0em":3===g?"0.71em":"0.32em")),e!==c&&(u=u.transition(e),h=h.transition(e),x=x.transition(e),b=b.transition(e),y=y.transition(e).attr("opacity",Xr).attr("transform",function(e){return isFinite(e=p(e))?l(e):this.getAttribute("transform")}),_.attr("opacity",Xr).attr("transform",function(e){var t=this.parentNode.__axis;return l(t&&isFinite(t=t(e))?t:p(e))})),y.remove(),u.attr("d",4===g||2==g?O?"M"+t*O+","+o+"H0.5V"+d+"H"+t*O:"M0.5,"+o+"V"+d:O?"M"+o+","+t*O+"V0.5H"+d+"V"+t*O:"M"+o+",0.5H"+d),h.attr("opacity",1).attr("transform",function(e){return l(p(e))}),x.attr(s+"2",t*D),b.attr(s,t*r).text(a),c.filter(v).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===g?"start":4===g?"end":"middle"),c.each(function(){this.__axis=p})}var f=[],C=null,z=null,D=6,O=6,R=3,t=1===g||4===g?-1:1,s=4===g||2===g?"x":"y",l=1===g||3===g?h:p;return d.scale=function(e){return arguments.length?(m=e,d):m},d.ticks=function(){return f=i.call(arguments),d},d.tickArguments=function(e){return arguments.length?(f=null==e?[]:i.call(e),d):f.slice()},d.tickValues=function(e){return arguments.length?(C=null==e?null:i.call(e),d):C&&C.slice()},d.tickFormat=function(e){return arguments.length?(z=e,d):z},d.tickSize=function(e){return arguments.length?(D=O=+e,d):D},d.tickSizeInner=function(e){return arguments.length?(D=+e,d):D},d.tickSizeOuter=function(e){return arguments.length?(O=+e,d):O},d.tickPadding=function(e){return arguments.length?(R=+e,d):R},d}function ja(){for(var a,i=0,o=arguments.length,e={};i<o;++i){if(!(a=arguments[i]+"")||a in e||/[\s.]/.test(a))throw new Error("illegal type: "+a);e[a]=[]}return new l(e)}function l(e){this._=e}function s(e,a){return e.trim().split(/^|\s+/).map(function(n){var i="",l=n.indexOf(".");if(0<=l&&(i=n.slice(l+1),n=n.slice(0,l)),n&&!a.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}function d(a,t){for(var n,l=0,o=a.length;l<o;++l)if((n=a[l]).name===t)return n.value}function m(a,l,n){for(var e=0,o=a.length;e<o;++e)if(a[e].name===l){a[e]=c,a=a.slice(0,e).concat(a.slice(e+1));break}return null!=n&&a.push({name:l,value:n}),a}function y(a){var i=a+="",l=i.indexOf(":");return 0<=l&&"xmlns"!==(i=a.slice(0,l))&&(a=a.slice(l+1)),r.hasOwnProperty(i)?{space:r[i],local:a}:a}function x(a){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n==="http://www.w3.org/1999/xhtml"&&t.documentElement.namespaceURI==="http://www.w3.org/1999/xhtml"?t.createElement(a):t.createElementNS(n,a)}}function b(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function w(e){var t=y(e);return(t.local?b:x)(t)}function k(){}function T(e){return null==e?k:function(){return this.querySelector(e)}}function C(){return[]}function S(e){return null==e?C:function(){return this.querySelectorAll(e)}}function E(e){return function(){return this.matches(e)}}function P(e){return Array(e.length)}function z(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function O(d,t,n,e,r,i){for(var o,p=0,c=t.length,s=i.length;p<s;++p)(o=t[p])?(o.__data__=i[p],e[p]=o):n[p]=new z(d,i[p]);for(;p<c;++p)(o=t[p])&&(r[p]=o)}function M(d,t,n,e,r,i,o){var a,g,m,y={},c=t.length,h=i.length,f=Array(c);for(a=0;a<c;++a)(g=t[a])&&(f[a]=m="$"+o.call(g,g.__data__,a,t),m in y?r[a]=g:y[m]=g);for(a=0;a<h;++a)(g=y[m="$"+o.call(d,i[a],a,i)])?(e[a]=g,g.__data__=i[a],y[m]=null):n[a]=new z(d,i[a]);for(a=0;a<c;++a)(g=t[a])&&y[f[a]]===g&&(r[a]=g)}function R(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function j(e){return function(){this.removeAttribute(e)}}function D(e){return function(){this.removeAttributeNS(e.space,e.local)}}function X(e,t){return function(){this.setAttribute(e,t)}}function q(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function I(a,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(a):this.setAttribute(a,n)}}function V(a,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,n)}}function H(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $(e){return function(){this.style.removeProperty(e)}}function B(a,t,n){return function(){this.style.setProperty(a,t,n)}}function F(a,t,n){return function(){var e=t.apply(this,arguments);null==e?this.style.removeProperty(a):this.style.setProperty(a,e,n)}}function Y(e,t){return e.style.getPropertyValue(t)||H(e).getComputedStyle(e,null).getPropertyValue(t)}function U(e){return function(){delete this[e]}}function G(e,t){return function(){this[e]=t}}function Z(a,t){return function(){var n=t.apply(this,arguments);null==n?delete this[a]:this[a]=n}}function K(e){return e.trim().split(/^|\s+/)}function Q(e){return e.classList||new J(e)}function J(e){this._node=e,this._names=K(e.getAttribute("class")||"")}function W(a,t){for(var n=Q(a),e=-1,l=t.length;++e<l;)n.add(t[e])}function et(a,t){for(var n=Q(a),e=-1,l=t.length;++e<l;)n.remove(t[e])}function tt(e){return function(){W(this,e)}}function nt(e){return function(){et(this,e)}}function at(e,t){return function(){(t.apply(this,arguments)?W:et)(this,e)}}function rt(){this.textContent=""}function it(e){return function(){this.textContent=e}}function lt(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ot(){this.innerHTML=""}function st(e){return function(){this.innerHTML=e}}function pt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function dt(){this.nextSibling&&this.parentNode.appendChild(this)}function ct(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ut(){return null}function ht(){var e=this.parentNode;e&&e.removeChild(this)}function gt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function mt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ft(a,r,n){return a=yt(a,r,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||a.call(this,t)}}function yt(a,t,n){return function(e){var r=f;f=e;try{a.call(this,this.__data__,t,n)}finally{f=r}}}function _t(e){return e.trim().split(/^|\s+/).map(function(a){var r="",i=a.indexOf(".");return 0<=i&&(r=a.slice(i+1),a=a.slice(0,i)),{type:a,name:r}})}function vt(a){return function(){var t=this.__on;if(t){for(var n,l=0,s=-1,d=t.length;l<d;++l)n=t[l],a.type&&n.type!==a.type||n.name!==a.name?t[++s]=n:this.removeEventListener(n.type,n.listener,n.capture);++s?t.length=s:delete this.__on}}}function wt(d,t,n){var e=u.hasOwnProperty(d.type)?ft:yt;return function(r,i,o){var a,p=this.__on,s=e(t,i,o);if(p)for(var l=0,g=p.length;l<g;++l)if((a=p[l]).type===d.type&&a.name===d.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=s,a.capture=n),void(a.value=t);this.addEventListener(d.type,s,n),a={type:d.type,name:d.name,value:t,listener:s,capture:n},p?p.push(a):this.__on=[a]}}function kt(a,t,n,e){var r=f;a.sourceEvent=f,f=a;try{return t.apply(n,e)}finally{f=r}}function St(a,t,n){var e=H(a),r=e.CustomEvent;"function"==typeof r?r=new r(t,n):(r=e.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),a.dispatchEvent(r)}function Tt(e,t){return function(){return St(this,e,t)}}function At(e,t){return function(){return St(this,e,t.apply(this,arguments))}}function Ct(e,t){this._groups=e,this._parents=t}function Et(){return new Ct([[document.documentElement]],_)}function Lt(e){return"string"==typeof e?new Ct([[document.querySelector(e)]],[document.documentElement]):new Ct([[e]],_)}function Pt(){for(var e,a=f;e=a.sourceEvent;)a=e;return a}function Nt(a,t){var n=a.ownerSVGElement||a;if(n.createSVGPoint){var e=n.createSVGPoint();return e.x=t.clientX,e.y=t.clientY,[(e=e.matrixTransform(a.getScreenCTM().inverse())).x,e.y]}var l=a.getBoundingClientRect();return[t.clientX-l.left-a.clientLeft,t.clientY-l.top-a.clientTop]}function zt(e){var t=Pt();return t.changedTouches&&(t=t.changedTouches[0]),Nt(e,t)}function Ot(a,t,l){3>arguments.length&&(l=t,t=Pt().changedTouches);for(var s,d=0,p=t?t.length:0;d<p;++d)if((s=t[d]).identifier===l)return Nt(a,s);return null}function Mt(){f.stopImmediatePropagation()}function Rt(){f.preventDefault(),f.stopImmediatePropagation()}function Dt(a){var t=a.document.documentElement,n=Lt(a).on("dragstart.drag",Rt,!0);"onselectstart"in t?n.on("selectstart.drag",Rt,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function jt(e){return function(){return e}}function Xt(d,t,n,e,r,i,o,a,p,s){this.target=d,this.type=t,this.subject=n,this.identifier=e,this.active=r,this.x=i,this.y=o,this.dx=a,this.dy=p,this._=s}function It(){return!f.ctrlKey&&!f.button}function Vt(){return this.parentNode}function Ht(e){return null==e?{x:f.x,y:f.y}:e}function $t(){return navigator.maxTouchPoints||"ontouchstart"in this}function Bt(a,t,n){a.prototype=t.prototype=n,n.constructor=a}function Ft(a,t){var n=Object.create(a.prototype);for(var e in t)n[e]=t[e];return n}function Yt(){}function Ut(){return this.rgb().formatHex()}function Gt(){return this.rgb().formatRgb()}function Zt(a){var r,i;return a=(a+"").trim().toLowerCase(),(r=Jt.exec(a))?(i=r[1].length,r=parseInt(r[1],16),6===i?Kt(r):3===i?new gn(15&r>>8|240&r>>4,15&r>>4|240&r,(15&r)<<4|15&r,1):8===i?Qt(255&r>>24,255&r>>16,255&r>>8,(255&r)/255):4===i?Qt(15&r>>12|240&r>>8,15&r>>8|240&r>>4,15&r>>4|240&r,((15&r)<<4|15&r)/255):null):(r=Wt.exec(a))?new gn(r[1],r[2],r[3],1):(r=rn.exec(a))?new gn(255*r[1]/100,255*r[2]/100,255*r[3]/100,1):(r=an.exec(a))?Qt(r[1],r[2],r[3],r[4]):(r=on.exec(a))?Qt(255*r[1]/100,255*r[2]/100,255*r[3]/100,r[4]):(r=sn.exec(a))?_n(r[1],r[2]/100,r[3]/100,1):(r=ln.exec(a))?_n(r[1],r[2]/100,r[3]/100,r[4]):cn.hasOwnProperty(a)?Kt(cn[a]):"transparent"===a?new gn(NaN,NaN,NaN,0):null}function Kt(e){return new gn(255&e>>16,255&e>>8,255&e,1)}function Qt(a,i,l,o){return 0>=o&&(a=i=l=NaN),new gn(a,i,l,o)}function dn(e){return e instanceof Yt||(e=Zt(e)),e?new gn((e=e.rgb()).r,e.g,e.b,e.opacity):new gn}function pn(a,t,n,e){return 1===arguments.length?dn(a):new gn(a,t,n,null==e?1:e)}function gn(a,t,n,e){this.r=+a,this.g=+t,this.b=+n,this.opacity=+e}function mn(){return"#"+yn(this.r)+yn(this.g)+yn(this.b)}function fn(){var e=this.opacity;return(1===(e=isNaN(e)?1:pa(0,da(1,e)))?"rgb(":"rgba(")+pa(0,da(255,ra(this.r)||0))+", "+pa(0,da(255,ra(this.g)||0))+", "+pa(0,da(255,ra(this.b)||0))+(1===e?")":", "+e+")")}function yn(e){return(16>(e=pa(0,da(255,ra(e)||0)))?"0":"")+e.toString(16)}function _n(a,i,l,o){return 0>=o?a=i=l=NaN:0>=l||1<=l?a=i=NaN:0>=i&&(a=NaN),new xn(a,i,l,o)}function vn(l){if(l instanceof xn)return new xn(l.h,l.s,l.l,l.opacity);if(l instanceof Yt||(l=Zt(l)),!l)return new xn;if(l instanceof xn)return l;var d=(l=l.rgb()).r/255,n=l.g/255,e=l.b/255,r=da(d,n,e),i=pa(d,n,e),o=NaN,p=i-r,c=(i+r)/2;return p?(o=d===i?(n-e)/p+6*(n<e):n===i?(e-d)/p+2:(d-n)/p+4,p/=.5>c?i+r:2-i-r,o*=60):p=0<c&&1>c?0:o,new xn(o,p,c,l.opacity)}function xn(a,t,n,e){this.h=+a,this.s=+t,this.l=+n,this.opacity=+e}function bn(a,t,n){return 255*(60>a?t+(n-t)*a/60:180>a?n:240>a?t+(n-t)*(240-a)/60:t)}function wn(e){return function(){return e}}function kn(a){return 1==(a=+a)?Sn:function(t,n){return n-t?function(a,i,l){return a=la(a,l),i=la(i,l)-a,l=1/l,function(e){return la(a+e*i,l)}}(t,n,a):wn(isNaN(t)?n:t)}}function Sn(a,t){var n=t-a;return n?function(a,t){return function(n){return a+n*t}}(a,n):wn(isNaN(a)?t:a)}function Tn(a,t){t||(t=[]);var l,s=a?da(t.length,a.length):0,r=t.slice();return function(e){for(l=0;l<s;++l)r[l]=a[l]*(1-e)+t[l]*e;return r}}function Cn(l,t){var n,s=t?t.length:0,r=l?da(s,l.length):0,i=Array(r),o=Array(s);for(n=0;n<r;++n)i[n]=zn(l[n],t[n]);for(;n<s;++n)o[n]=t[n];return function(e){for(n=0;n<r;++n)o[n]=i[n](e);return o}}function An(a,i){var l=new Date;return a=+a,i=+i,function(e){return l.setTime(a*(1-e)+i*e),l}}function En(a,r){return a=+a,r=+r,function(t){return a*(1-t)+r*t}}function Ln(a,l){var o,s={},r={};for(o in null!==a&&"object"==_typeof(a)||(a={}),null!==l&&"object"==_typeof(l)||(l={}),l)o in a?s[o]=zn(a[o],l[o]):r[o]=l[o];return function(e){for(o in s)r[o]=s[o](e);return r}}function Nn(l,d){var p,c,h,g=Pn.lastIndex=Xn.lastIndex=0,m=-1,f=[],u=[];for(l+="",d+="";(p=Pn.exec(l))&&(c=Xn.exec(d));)(h=c.index)>g&&(h=d.slice(g,h),f[m]?f[m]+=h:f[++m]=h),(p=p[0])===(c=c[0])?f[m]?f[m]+=c:f[++m]=c:(f[++m]=null,u.push({i:m,x:En(p,c)})),g=Xn.lastIndex;return g<d.length&&(h=d.slice(g),f[m]?f[m]+=h:f[++m]=h),2>f.length?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(d):(d=u.length,function(n){for(var t,a=0;a<d;++a)f[(t=u[a]).i]=t.x(n);return f.join("")})}function zn(a,t){var i,l=_typeof(t);return null==t||"boolean"===l?wn(t):("number"===l?En:"string"===l?(i=Zt(t))?(t=i,$r):Nn:t instanceof Zt?$r:t instanceof Date?An:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?Tn:Array.isArray(t)?Cn:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Ln:En)(a,t)}function Mn(a,r){return a=+a,r=+r,function(t){return ra(a*(1-t)+r*t)}}function Rn(l,d,p,c,h,i){var o,g,m;return(o=ea(l*l+d*d))&&(l/=o,d/=o),(m=l*p+d*c)&&(p-=l*m,c-=d*m),(g=ea(p*p+c*c))&&(p/=g,c/=g,m/=g),l*c<d*p&&(l=-l,d=-d,m=-m,o=-o),{translateX:h,translateY:i,rotate:Math.atan2(d,l)*On,skewX:nn(m)*On,scaleX:o,scaleY:g}}function jn(l,d,n,a){function s(e){return e.length?e.pop()+" ":""}return function(e,t){var i=[],p=[];return e=l(e),t=l(t),function(e,t,r,i,l,a){if(e!==r||t!==i){var o=l.push("translate(",null,d,null,n);a.push({i:o-4,x:En(e,r)},{i:o-2,x:En(t,i)})}else(r||i)&&l.push("translate("+r+d+i+n)}(e.translateX,e.translateY,t.translateX,t.translateY,i,p),function(r,i,l,e){r===i?i&&l.push(s(l)+"rotate("+i+a):(180<r-i?i+=360:180<i-r&&(r+=360),e.push({i:l.push(s(l)+"rotate(",null,a)-2,x:En(r,i)}))}(e.rotate,t.rotate,i,p),function(r,t,n,e){r===t?t&&n.push(s(n)+"skewX("+t+a):e.push({i:n.push(s(n)+"skewX(",null,a)-2,x:En(r,t)})}(e.skewX,t.skewX,i,p),function(i,t,n,e,r,l){if(i!==n||t!==e){var a=r.push(s(r)+"scale(",null,",",null,")");l.push({i:a-4,x:En(i,n)},{i:a-2,x:En(t,e)})}else 1===n&&1===e||r.push(s(r)+"scale("+n+","+e+")")}(e.scaleX,e.scaleY,t.scaleX,t.scaleY,i,p),e=t=null,function(a){for(var t,l=-1,o=p.length;++l<o;)i[(t=p[l]).i]=t.x(a);return i.join("")}}}function qn(){return Ur||(oe(ue),Ur=Zr.now()+Gr)}function ue(){Ur=0}function se(){this._call=this._time=this._next=null}function le(a,t,n){var e=new se;return e.restart(a,t,n),e}function ce(){Ur=(Yr=Zr.now())+Gr,Jn=Br=0;try{!function(){qn(),++Jn;for(var e,a=Vr;a;)0<=(e=Ur-a._time)&&a._call.call(null,e),a=a._next;--Jn}()}finally{Jn=0,function(){for(var a,i,l=Vr,o=1/0;l;)l._call?(o>l._time&&(o=l._time),a=l,l=l._next):(i=l._next,l._next=null,l=a?a._next=i:Vr=i);Hr=a,fe(o)}(),Ur=0}}function he(){var e=Zr.now(),t=e-Yr;1e3<t&&(Gr-=t,Yr=e)}function fe(e){Jn||(Br&&(Br=clearTimeout(Br)),24<e-Ur?(e<1/0&&(Br=setTimeout(ce,e-Zr.now()-Gr)),Fr&&(Fr=clearInterval(Fr))):(Fr||(Yr=Zr.now(),Fr=setInterval(he,1e3)),Jn=1,oe(ce)))}function pe(a,t,i){var l=new se;return t=null==t?0:+t,l.restart(function(n){l.stop(),a(n+t)},t,i),l}function de(l,t,n,e,r,i){var o=l.__transition;if(!o)l.__transition={};else if(n in o)return;!function(d,t,p){function e(r){var i,o,g,m;if(1!==p.state)return u();for(i in a)if((m=a[i]).name===p.name){if(3===m.state)return pe(e);4===m.state?(m.state=6,m.timer.stop(),m.on.call("interrupt",d,d.__data__,m.index,m.group),delete a[i]):+i<t&&(m.state=6,m.timer.stop(),m.on.call("cancel",d,d.__data__,m.index,m.group),delete a[i])}if(pe(function(){3===p.state&&(p.state=4,p.timer.restart(n,p.delay,p.time),n(r))}),p.state=2,p.on.call("start",d,d.__data__,p.index,p.group),2===p.state){for(p.state=3,s=Array(g=p.tween.length),i=0,o=-1;i<g;++i)(m=p.tween[i].value.call(d,d.__data__,p.index,p.group))&&(s[++o]=m);s.length=o+1}}function n(e){for(var t=e<p.duration?p.ease.call(null,e/p.duration):(p.timer.restart(u),p.state=5,1),n=-1,r=s.length;++n<r;)s[n].call(d,t);5===p.state&&(p.on.call("end",d,d.__data__,p.index,p.group),u())}function u(){for(var e in p.state=6,p.timer.stop(),delete a[t],a)return;delete d.__transition}var s,a=d.__transition;a[t]=p,p.timer=le(function(n){p.state=1,p.timer.restart(e,p.delay,p.time),p.delay<=n&&e(n-p.delay)},0,p.time)}(l,n,{name:t,index:e,group:r,on:ae,tween:ge,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function me(a,t){var n=_e(a,t);if(0<n.state)throw new Error("too late; already scheduled");return n}function ye(a,t){var n=_e(a,t);if(3<n.state)throw new Error("too late; already running");return n}function _e(a,t){var n=a.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function we(l,t){var n,s;return function(){var e=ye(this,l),r=e.tween;if(r!==n)for(var i=0,o=(s=n=r).length;i<o;++i)if(s[i].name===t){(s=s.slice()).splice(i,1);break}e.tween=s}}function xe(d,t,n){var e,p;if("function"!=typeof n)throw new Error;return function(){var r=ye(this,d),i=r.tween;if(i!==e){p=(e=i).slice();for(var a={name:t,value:n},o=0,c=p.length;o<c;++o)if(p[o].name===t){p[o]=a;break}o===c&&p.push(a)}r.tween=p}}function be(a,i,n){var e=a._id;return a.each(function(){var a=ye(this,e);(a.value||(a.value={}))[i]=n.apply(this,arguments)}),function(n){return _e(n,e).value[i]}}function Me(a,t){var r;return("number"==typeof t?En:t instanceof Zt?$r:(r=Zt(t))?(t=r,$r):Nn)(a,t)}function ke(e){return function(){this.removeAttribute(e)}}function Ne(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ae(l,t,n){var e,o;return function(){var r=this.getAttribute(l);return r===n+""?null:r===e?o:o=t(e=r,n)}}function Ee(l,t,n){var e,o;return function(){var r=this.getAttributeNS(l.space,l.local);return r===n+""?null:r===e?o:o=t(e=r,n)}}function Se(l,t,n){var e,d,p;return function(){var r,i,o=n(this);return null==o?void this.removeAttribute(l):(r=this.getAttribute(l))===(i=o+"")?null:r===e&&i===d?p:(d=i,p=t(e=r,o))}}function Te(l,t,n){var e,d,p;return function(){var r,i,o=n(this);return null==o?void this.removeAttributeNS(l.space,l.local):(r=this.getAttributeNS(l.space,l.local))===(i=o+"")?null:r===e&&i===d?p:(d=i,p=t(e=r,o))}}function Pe(a,t){return function(n){this.setAttribute(a,t.call(this,n))}}function Ce(a,t){return function(n){this.setAttributeNS(a.space,a.local,t.call(this,n))}}function qe(a,t){function n(){var e=t.apply(this,arguments);return e!==o&&(l=(o=e)&&Ce(a,e)),l}var l,o;return n._value=t,n}function ze(a,t){function n(){var e=t.apply(this,arguments);return e!==o&&(l=(o=e)&&Pe(a,e)),l}var l,o;return n._value=t,n}function Le(e,t){return function(){me(this,e).delay=+t.apply(this,arguments)}}function je(e,t){return t=+t,function(){me(this,e).delay=t}}function Xe(e,t){return function(){ye(this,e).duration=+t.apply(this,arguments)}}function Oe(e,t){return t=+t,function(){ye(this,e).duration=t}}function Ve(e,t){if("function"!=typeof t)throw new Error;return function(){ye(this,e).ease=t}}function Re(l,t,n){var e,s,d=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var a=e.indexOf(".");return 0<=a&&(e=e.slice(0,a)),!e||"start"===e})}(t)?me:ye;return function(){var r=d(this,l),a=r.on;a!==e&&(s=(e=a).copy()).on(t,n),r.on=s}}function Ie(e){return function(){this.style.removeProperty(e)}}function $e(a,t,n){return function(e){this.style.setProperty(a,t.call(this,e),n)}}function He(a,t,n){function e(){var e=t.apply(this,arguments);return e!==s&&(l=(s=e)&&$e(a,e,n)),l}var l,s;return e._value=t,e}function Fe(e){return function(t){this.textContent=e.call(this,t)}}function Ye(a){function t(){var e=a.apply(this,arguments);return e!==l&&(i=(l=e)&&Fe(e)),i}var i,l;return t._value=a,t}function Be(a,t,n,e){this._groups=a,this._parents=t,this._name=n,this._id=e}function Ge(){return++De}function Ze(a,r){for(var n;!(n=a.__transition)||!(n=n[r]);)if(!(a=a.parentNode))return Ke.time=qn(),Ke;return n}function Je(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function In(){return new Je}function Vn(){}function Un(l,t){var s=new Vn;if(l instanceof Vn)l.each(function(e,t){s.set(t,e)});else if(Array.isArray(l)){var e,n=-1,d=l.length;if(null==t)for(;++n<d;)s.set(n,l[n]);else for(;++n<d;)s.set(t(e=l[n],n,l),e)}else if(l)for(var o in l)s.set(o,l[o]);return s}function Gn(){}function Xa(a,i){if(0>(n=(a=i?a.toExponential(i-1):a.toExponential()).indexOf("e")))return null;var n,l=a.slice(0,n);return[1<l.length?l[0]+l.slice(2):l,+a.slice(n+1)]}function qa(e){return(e=Xa(tn(e)))?e[1]:NaN}function Ia(e){if(!(t=Qr.exec(e)))throw new Error("invalid format: "+e);var t;return new Va({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Va(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ha(a,t){var n=Xa(a,t);if(!n)return a+"";var e=n[0],r=n[1];return 0>r?"0."+Array(-r).join("0")+e:e.length>r+1?e.slice(0,r+1)+"."+e.slice(r+1):e+Array(r-e.length+2).join("0")}function $a(e){return e}function Ba(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);}return this}function Fa(e){return+e}function Ya(e){return e}function Ua(a,r){return(r-=a=+a)?function(t){return(t-a)/r}:function(e){return function(){return e}}(isNaN(r)?NaN:.5)}function Ga(a){var t,i=a[0],l=a[a.length-1];return i>l&&(t=i,i=l,l=t),function(e){return pa(i,da(l,e))}}function Za(l,t,n){var e=l[0],s=l[1],i=t[0],d=t[1];return s<e?(e=Ua(s,e),i=n(d,i)):(e=Ua(e,s),i=n(i,d)),function(n){return i(e(n))}}function Ka(i,l,s){var d=da(i.length,l.length)-1,r=Array(d),o=Array(d),e=-1;for(i[d]<i[0]&&(i=i.slice().reverse(),l=l.slice().reverse());++e<d;)r[e]=Ua(i[e],i[e+1]),o[e]=s(l[e],l[e+1]);return function(t){var n=Rr(i,t,1,d)-1;return o[n](r[n](t))}}function Qa(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Ja(){function d(){return m=2<da(_.length,v.length)?Ka:Za,f=y=null,p}function p(e){return isNaN(e=+e)?g:(f||(f=m(_.map(c),v,x)))(c(b(e)))}var c,h,g,m,f,y,_=Er,v=Er,x=zn,b=Ya;return p.invert=function(t){return b(h((y||(y=m(v,_.map(c),En)))(t)))},p.domain=function(e){return arguments.length?(_=Nr.call(e,Fa),b===Ya||(b=Ga(_)),d()):_.slice()},p.range=function(e){return arguments.length?(v=Ar.call(e),d()):v.slice()},p.rangeRound=function(e){return v=Ar.call(e),x=Mn,d()},p.clamp=function(e){return arguments.length?(b=e?Ga(_):Ya,p):b!==Ya},p.interpolate=function(e){return arguments.length?(x=e,d()):x},p.unknown=function(e){return arguments.length?(g=e,p):g},function(t,e){return c=t,h=e,d()}}function Wa(e,t){return Ja()(e,t)}function er(t,n,e,r){var d,p=function(l,t,n){var e=tn(t-l)/pa(0,n),r=la(10,aa(sa(e)/ta)),d=e/r;return d>=jr?r*=10:d>=o?r*=5:d>=a&&(r*=2),t<l?-r:r}(t,n,e);switch((r=Ia(null==r?",f":r)).type){case"s":var l=pa(tn(t),tn(n));return null!=r.precision||isNaN(d=function(e,t){return pa(0,3*pa(-8,da(8,aa(qa(t)/3)))-qa(tn(e)))}(p,l))||(r.precision=d),Jr(r,l);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(d=function(e,a){return e=tn(e),a=tn(a)-e,pa(0,qa(a)-qa(e))+1}(p,pa(tn(t),tn(n))))||(r.precision=d-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(d=function(e){return pa(0,-qa(tn(e)))}(p))||(r.precision=d-2*("%"===r.type));}return Mr.format(r)}function ar(l){var d=l.domain;return l.ticks=function(n){var t=d();return za(t[0],t[t.length-1],null==n?10:n)},l.tickFormat=function(n,t){var e=d();return er(e[0],e[e.length-1],null==n?10:n,t)},l.nice=function(t){null==t&&(t=10);var n,p=d(),i=0,c=p.length-1,h=p[i],g=p[c];return g<h&&(n=h,h=g,g=n,n=i,i=c,c=n),0<(n=Da(h,g,t))?n=Da(h=aa(h/n)*n,g=na(g/n)*n,t):0>n&&(n=Da(h=na(h*n)/n,g=aa(g*n)/n,t)),0<n?(p[i]=aa(h/n)*n,p[c]=na(g/n)*n,d(p)):0>n&&(p[i]=na(h*n)/n,p[c]=aa(g*n)/n,d(p)),l},l}function rr(e){return sa(e)}function ir(e){return oa(e)}function or(e){return-sa(-e)}function sr(e){return-oa(-e)}function dr(e){return isFinite(e)?+("1e"+e):0>e?0:e}function cr(e){return function(t){return-e(-t)}}function ur(t){function n(){var e=Math.E;return s=function(a){return a===e?sa:10===a&&ia||2===a&&Math.log2||(a=sa(a),function(e){return sa(e)/a})}(_),m=function(a){return 10===a?dr:a===e?oa:function(e){return la(a,e)}}(_),0>y()[0]?(s=cr(s),m=cr(m),t(or,sr)):t(rr,ir),l}var s,m,l=t(rr,ir),y=l.domain,_=10;return l.base=function(e){return arguments.length?(_=+e,n()):_},l.domain=function(e){return arguments.length?(y(e),n()):y()},l.ticks=function(e){var t,a=y(),r=a[0],i=a[a.length-1];(t=i<r)&&(w=r,r=i,i=w);var o,x,b,w=s(r),k=s(i),T=null==e?10:+e,g=[];if(!(!(_%1)&&k-w<T))g=za(w,k,da(k-w,T)).map(m);else if(w=ra(w)-1,k=ra(k)+1,0<r){for(;w<k;++w)for(x=1,o=m(w);x<_;++x)if(!((b=o*x)<r)){if(b>i)break;g.push(b)}}else for(;w<k;++w)for(x=_-1,o=m(w);1<=x;--x)if(!((b=o*x)<r)){if(b>i)break;g.push(b)}return t?g.reverse():g},l.tickFormat=function(e,a){if(null==a&&(a=10===_?".0e":","),"function"!=typeof a&&(a=Mr.format(a)),e===1/0)return a;null==e&&(e=10);var r=pa(1,_*e/l.ticks().length);return function(e){var t=e/m(ra(s(e)));return t*_<_-.5&&(t*=_),t<=r?a(e):""}},l.nice=function(){return y(function(l,s){var n,d=0,p=(l=l.slice()).length-1,c=l[d],u=l[p];return u<c&&(n=d,d=p,p=n,n=c,c=u,u=n),l[d]=s.floor(c),l[p]=s.ceil(u),l}(y(),{floor:function(e){return m(aa(s(e)))},ceil:function(e){return m(na(s(e)))}}))},l}function hr(e){return function(){return e}}function gr(e){this._context=e}function yr(e){return new gr(e)}function vr(e){return e[0]}function kr(e){return e[1]}for(var Cr=18.01528/28.9644,Sr=6.112,Lr=273.15,Pr=-.0065,zr=9.80665,g=new Uint8Array(256),Dr=0;160>Dr;Dr++)g[Dr]=Aa(24*aa((Dr+12)/16),160);var Or={computeClouds:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:200,r=function(e,t,n){var a=ia(e),r=[ia(t[0]),ia(t[1])],i=r[1]-r[0],l=n[1]-n[0];return n[0]+(a-r[0])/i*l},i={},l=[],o=[];e.forEach(function(e){if(e.press&&(null==e.rh&&e.dwpt&&e.temp&&(e.rh=100*(oa(17.625*e.dwpt/(243.04+e.dwpt))/oa(17.625*e.temp/(243.04+e.temp)))),e.rh&&100<=e.press)){var t=ra(e.press);i["rh-".concat(t,"h")]=[e.rh],l.push(t),o.push(r(t,[1050,100],[0,100]))}}),i["rh-".concat(l[0]+1,"h")]=[0],o.unshift(null,o[0]),l.unshift(null,l[0]+1),l.pop(),l.push(null);for(var s=i["rh-".concat(l[1],"h")].length,d=l.length,p=Array(s*d),c=0,a=0;c<d;++c)if(null==l[c])for(var u=0;u<s;++u)p[a++]=0;else for(var h=.01*o[c],g=Sa(-60,-70,h),m=Sa(.025,.038,h),f=Sa(6,4,h),y=1-.8*la(h,.7),_=i["rh-".concat(l[c],"h")],v=0;v<s;++v){var x=+_[v],b=pa(0,da((x+g)*m,1));b=la(b,f)*y,p[a++]=b}for(var w,k=t||10,T=k*s,C=n||300,S=Array(T*C),A=2*C,E=Array(A),P=Array(16),N=C,z=0;z<d-1;++z){w=N,N=ra(C-1-o[z+1]*(.01*(C-1)));for(var D=s*Aa(z+2,d),O=s*Aa(z+1,d),M=s*Aa(z+0,d),R=s*Aa(z-1,d),j=0,X=k+1>>1,q=w-N,I=0;I<s+1;++I){if(0==I&&0<q)for(var V=0;V<q;V++)E[--A]=z,E[--A]=ra(1e4*(1/q)*V);var H=Aa(I-2,s),$=Aa(I-1,s),B=Aa(I+0,s),F=Aa(I+1,s);P[0]=p[D+H],P[1]=p[D+$],P[2]=p[D+B],P[3]=p[D+F],P[4]=p[O+H],P[5]=p[O+$],P[6]=p[O+B],P[7]=p[O+F],P[8]=p[M+H],P[9]=p[M+$],P[10]=p[M+B],P[11]=p[M+F],P[12]=p[R+H],P[13]=p[R+$],P[14]=p[R+B],P[15]=p[R+F];for(var Y,U=N*T+j,G=X-j,Z=0;Z<q;++Z){Y=U+Z*T;for(var K,Q=0;Q<G;++Q)K=La(160*Pa(P,1/G*Q,1/q*Z)),S[Y++]=255-K}j=X,X+=k,X>T&&(X=T)}}return{clouds:S,width:T,height:C}},cloudsToCanvas:function(e){var t=e.clouds,n=e.width,a=e.height,r=e.canvas;null==r&&(r=document.createElement("canvas")),r.width=n,r.height=a;for(var i=r.getContext("2d"),l=i.getImageData(0,0,n,a),o=l.data,s=0,d=0,p=0;p<n;++p)for(var c,u=0;u<a;++u)c=t[s++],o[d++]=c,o[d++]=c,o[d++]=c,o[d++]=245>c?255:0;return i.putImageData(l,0,0),i.drawImage(r,0,0,n,a),r}},Mr={},t=n(Na),Rr=t.right,jr=ea(50),o=ea(10),a=ea(2),i=Array.prototype.slice,Xr=1e-6,c={value:function(){}};l.prototype=ja.prototype={constructor:l,on:function(l,p){var n,c=this._,r=s(l+"",c),i=-1,u=r.length;if(!(2>arguments.length)){if(null!=p&&"function"!=typeof p)throw new Error("invalid callback: "+p);for(;++i<u;)if(n=(l=r[i]).type)c[n]=m(c[n],l.name,p);else if(null==p)for(n in c)c[n]=m(c[n],l.name,null);return this}for(;++i<u;)if((n=(l=r[i]).type)&&(n=d(c[n],l.name)))return n},copy:function(){var a={},t=this._;for(var n in t)a[n]=t[n].slice();return new l(a)},call:function(a,t){if(0<(n=arguments.length-2))for(var n,l,s=Array(n),i=0;i<n;++i)s[i]=arguments[i+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(i=0,n=(l=this._[a]).length;i<n;++i)l[i].value.apply(t,s)},apply:function(a,t,n){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var e=this._[a],r=0,l=e.length;r<l;++r)e[r].value.apply(t,n)}};var r={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};z.prototype={constructor:z,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},J.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return 0<=this._names.indexOf(e)}};var u={},f=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(u={mouseenter:"mouseover",mouseleave:"mouseout"}));var _=[null];Ct.prototype=Et.prototype={constructor:Ct,select:function(d){"function"!=typeof d&&(d=T(d));for(var p=this._groups,n=p.length,e=Array(n),r=0;r<n;++r)for(var h,g,m=p[r],u=m.length,s=e[r]=Array(u),l=0;l<u;++l)(h=m[l])&&(g=d.call(h,h.__data__,l,m))&&("__data__"in h&&(g.__data__=h.__data__),s[l]=g);return new Ct(e,this._parents)},selectAll:function(d){"function"!=typeof d&&(d=S(d));for(var p=this._groups,n=p.length,e=[],r=[],i=0;i<n;++i)for(var c,h=p[i],u=h.length,s=0;s<u;++s)(c=h[s])&&(e.push(d.call(c,c.__data__,s,h)),r.push(c));return new Ct(e,r)},filter:function(d){"function"!=typeof d&&(d=E(d));for(var p=this._groups,n=p.length,e=Array(n),r=0;r<n;++r)for(var c,h=p[r],a=h.length,u=e[r]=[],s=0;s<a;++s)(c=h[s])&&d.call(c,c.__data__,s,h)&&u.push(c);return new Ct(e,this._parents)},data:function(x,b){if(!x)return f=Array(this.size()),s=-1,this.each(function(e){f[++s]=e}),f;var n=b?M:O,e=this._parents,r=this._groups;"function"!=typeof x&&(x=function(e){return function(){return e}}(x));for(var i=r.length,o=Array(i),k=Array(i),u=Array(i),s=0;s<i;++s){var T=e[s],c=r[s],h=c.length,f=x.call(T,T&&T.__data__,s,e),C=f.length,d=k[s]=Array(C),g=o[s]=Array(C);n(T,c,d,g,u[s]=Array(h),f,b);for(var v,S,A=0,E=0;A<C;++A)if(v=d[A]){for(A>=E&&(E=A+1);!(S=g[E])&&++E<C;);v._next=S||null}}return(o=new Ct(o,e))._enter=k,o._exit=u,o},enter:function(){return new Ct(this._enter||this._groups.map(P),this._parents)},exit:function(){return new Ct(this._exit||this._groups.map(P),this._parents)},join:function(a,t,n){var e=this.enter(),l=this,s=this.exit();return e="function"==typeof a?a(e):e.append(a+""),null!=t&&(l=t(l)),null==n?s.remove():n(s),e&&l?e.merge(l).order():l},merge:function(d){for(var t=this._groups,n=d._groups,e=t.length,r=n.length,i=da(e,r),o=Array(e),a=0;a<i;++a)for(var g,m=t[a],l=n[a],c=m.length,h=o[a]=Array(c),f=0;f<c;++f)(g=m[f]||l[f])&&(h[f]=g);for(;a<e;++a)o[a]=t[a];return new Ct(o,this._parents)},order:function(){for(var l=this._groups,t=-1,s=l.length;++t<s;)for(var e,d=l[t],i=d.length-1,p=d[i];0<=--i;)(e=d[i])&&(p&&4^e.compareDocumentPosition(p)&&p.parentNode.insertBefore(e,p),p=e);return this},sort:function(d){function p(t,n){return t&&n?d(t.__data__,n.__data__):!t-!n}d||(d=R);for(var n=this._groups,e=n.length,r=Array(e),i=0;i<e;++i){for(var h,g=n[i],u=g.length,s=r[i]=Array(u),l=0;l<u;++l)(h=g[l])&&(s[l]=h);s.sort(p)}return new Ct(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var l=this._groups,t=0,s=l.length;t<s;++t)for(var e,d=l[t],r=0,p=d.length;r<p;++r)if(e=d[r],e)return e;return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(l){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var r,d=t[n],o=0,p=d.length;o<p;++o)(r=d[o])&&l.call(r,r.__data__,o,d);return this},attr:function(a,t){var n=y(a);if(2>arguments.length){var e=this.node();return n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}return this.each((null==t?n.local?D:j:"function"==typeof t?n.local?V:I:n.local?q:X)(n,t))},style:function(a,t,n){return 1<arguments.length?this.each((null==t?$:"function"==typeof t?F:B)(a,t,null==n?"":n)):Y(this.node(),a)},property:function(e,t){return 1<arguments.length?this.each((null==t?U:"function"==typeof t?Z:G)(e,t)):this.node()[e]},classed:function(a,t){var n=K(a+"");if(2>arguments.length){for(var e=Q(this.node()),r=-1,l=n.length;++r<l;)if(!e.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?at:t?tt:nt)(n,t))},text:function(e){return arguments.length?this.each(null==e?rt:("function"==typeof e?lt:it)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ot:("function"==typeof e?pt:st)(e)):this.node().innerHTML},raise:function(){return this.each(dt)},lower:function(){return this.each(ct)},append:function(e){var t="function"==typeof e?e:w(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(a,t){var n="function"==typeof a?a:w(a),e=null==t?ut:"function"==typeof t?t:T(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),e.apply(this,arguments)||null)})},remove:function(){return this.each(ht)},clone:function(e){return this.select(e?mt:gt)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(d,t,n){var p,h,g=_t(d+""),o=g.length;if(!(2>arguments.length)){for(a=t?wt:vt,null==n&&(n=!1),p=0;p<o;++p)this.each(a(g[p],t,n));return this}var a=this.node().__on;if(a)for(var m,f=0,y=a.length;f<y;++f)for(p=0,m=a[f];p<o;++p)if((h=g[p]).type===m.type&&h.name===m.name)return m.value},dispatch:function(e,t){return this.each(("function"==typeof t?At:Tt)(e,t))}},Xt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var A=.7,qt=1/A,Jt=/^#([0-9a-f]{3,8})$/,Wt=/^rgb\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*\)$/,rn=/^rgb\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,an=/^rgba\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,on=/^rgba\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,sn=/^hsl\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,ln=/^hsla\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,cn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bt(Yt,Zt,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Ut,formatHex:Ut,formatHsl:function(){return vn(this).formatHsl()},formatRgb:Gt,toString:Gt}),Bt(gn,pn,Ft(Yt,{brighter:function(e){return e=null==e?qt:la(qt,e),new gn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?A:la(A,e),new gn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&255.5>this.r&&-.5<=this.g&&255.5>this.g&&-.5<=this.b&&255.5>this.b&&0<=this.opacity&&1>=this.opacity},hex:mn,formatHex:mn,formatRgb:fn,toString:fn})),Bt(xn,function(a,t,n,e){return 1===arguments.length?vn(a):new xn(a,t,n,null==e?1:e)},Ft(Yt,{brighter:function(e){return e=null==e?qt:la(qt,e),new xn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?A:la(A,e),new xn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var a=this.h%360+360*(0>this.h),t=isNaN(a)||isNaN(this.s)?0:this.s,n=this.l,e=n+(.5>n?n:1-n)*t,r=2*n-e;return new gn(bn(240<=a?a-240:a+120,r,e),bn(a,r,e),bn(120>a?a+240:a-120,r,e),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:pa(0,da(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var un,hn,qr,Ir,Vr,Hr,$r=function a(t){function n(e,s){var d=l((e=pn(e)).r,(s=pn(s)).r),r=l(e.g,s.g),i=l(e.b,s.b),o=Sn(e.opacity,s.opacity);return function(t){return e.r=d(t),e.g=r(t),e.b=i(t),e.opacity=o(t),e+""}}var l=kn(t);return n.gamma=a,n}(1),Pn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xn=new RegExp(Pn.source,"g"),On=180/en,Yn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Bn=jn(function(e){return"none"===e?Yn:(un||(un=document.createElement("DIV"),hn=document.documentElement,qr=document.defaultView),un.style.transform=e,e=qr.getComputedStyle(hn.appendChild(un),null).getPropertyValue("transform"),hn.removeChild(un),Rn(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),Qn=jn(function(e){return null==e?Yn:(Ir||(Ir=document.createElementNS("http://www.w3.org/2000/svg","g")),Ir.setAttribute("transform",e),(e=Ir.transform.baseVal.consolidate())?Rn((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Yn)},", ",")",")"),Jn=0,Br=0,Fr=0,Yr=0,Ur=0,Gr=0,Zr="object"==("undefined"==typeof performance?"undefined":_typeof(performance))&&performance.now?performance:Date,oe="object"==("undefined"==typeof window?"undefined":_typeof(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};se.prototype=le.prototype={constructor:se,restart:function(a,t,n){if("function"!=typeof a)throw new TypeError("callback is not a function");n=(null==n?qn():+n)+(null==t?0:+t),this._next||Hr===this||(Hr?Hr._next=this:Vr=this,Hr=this),this._call=a,this._time=n,fe()},stop:function(){this._call&&(this._call=null,this._time=1/0,fe())}};var ae=ja("start","end","cancel","interrupt"),ge=[],ve=Et.prototype.constructor,De=0,Kr=Et.prototype;Be.prototype={constructor:Be,select:function(d){var p=this._name,n=this._id;"function"!=typeof d&&(d=T(d));for(var e=this._groups,r=e.length,i=Array(r),o=0;o<r;++o)for(var g,m,y=e[o],l=y.length,c=i[o]=Array(l),h=0;h<l;++h)(g=y[h])&&(m=d.call(g,g.__data__,h,y))&&("__data__"in g&&(m.__data__=g.__data__),c[h]=m,de(c[h],p,n,h,c,_e(g,n)));return new Be(i,this._parents,p,n)},selectAll:function(m){var y=this._name,n=this._id;"function"!=typeof m&&(m=S(m));for(var e=this._groups,r=e.length,i=[],o=[],a=0;a<r;++a)for(var _,x=e[a],l=x.length,c=0;c<l;++c)if(_=x[c]){for(var b,w=m.call(_,_.__data__,c,x),p=_e(_,n),d=0,k=w.length;d<k;++d)(b=w[d])&&de(b,y,n,d,w,p);i.push(w),o.push(_)}return new Be(i,o,y,n)},filter:function(d){"function"!=typeof d&&(d=E(d));for(var p=this._groups,n=p.length,e=Array(n),r=0;r<n;++r)for(var c,h=p[r],a=h.length,u=e[r]=[],s=0;s<a;++s)(c=h[s])&&d.call(c,c.__data__,s,h)&&u.push(c);return new Be(e,this._parents,this._name,this._id)},merge:function(d){if(d._id!==this._id)throw new Error;for(var t=this._groups,n=d._groups,e=t.length,r=n.length,i=da(e,r),o=Array(e),a=0;a<i;++a)for(var g,m=t[a],l=n[a],c=m.length,h=o[a]=Array(c),f=0;f<c;++f)(g=m[f]||l[f])&&(h[f]=g);for(;a<e;++a)o[a]=t[a];return new Be(o,this._parents,this._name,this._id)},selection:function(){return new ve(this._groups,this._parents)},transition:function(){for(var d=this._name,t=this._id,n=Ge(),e=this._groups,r=e.length,i=0;i<r;++i)for(var p,h=e[i],u=h.length,s=0;s<u;++s)if(p=h[s]){var g=_e(p,t);de(p,d,n,s,h,{time:g.time+g.delay+g.duration,delay:0,duration:g.duration,ease:g.ease})}return new Be(e,this._parents,d,n)},call:Kr.call,nodes:Kr.nodes,node:Kr.node,size:Kr.size,empty:Kr.empty,each:Kr.each,on:function(a,t){var n=this._id;return 2>arguments.length?_e(this.node(),n).on.on(a):this.each(Re(n,a,t))},attr:function(a,t){var n=y(a),e="transform"===n?Qn:Me;return this.attrTween(a,"function"==typeof t?(n.local?Te:Se)(n,e,be(this,"attr."+a,t)):null==t?(n.local?Ne:ke)(n):(n.local?Ee:Ae)(n,e,t))},attrTween:function(a,t){var n="attr."+a;if(2>arguments.length)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var i=y(a);return this.tween(n,(i.local?qe:ze)(i,t))},style:function(a,i,n){var e="transform"==(a+="")?Bn:Me;return null==i?this.styleTween(a,function(l,t){var n,s,d;return function(){var e=Y(this,l),r=(this.style.removeProperty(l),Y(this,l));return e===r?null:e===n&&r===s?d:d=t(n=e,s=r)}}(a,e)).on("end.style."+a,Ie(a)):"function"==typeof i?this.styleTween(a,function(l,t,n){var e,d,p;return function(){var r=Y(this,l),a=n(this),i=a+"";return null==a&&(this.style.removeProperty(l),i=a=Y(this,l)),r===i?null:r===e&&i===d?p:(d=i,p=t(e=r,a))}}(a,e,be(this,"style."+a,i))).each(function(d,t){var n,p,u,h,g="style."+t;return function(){var e=ye(this,d),a=e.on,r=null==e.value[g]?h||(h=Ie(t)):void 0;a===n&&u===r||(p=(n=a).copy()).on("end."+g,u=r),e.on=p}}(this._id,a)):this.styleTween(a,function(l,t,n){var e,o;return function(){var r=Y(this,l);return r===n+""?null:r===e?o:o=t(e=r,n)}}(a,e,i),n).on("end.style."+a,null)},styleTween:function(a,i,n){var e="style."+(a+="");if(2>arguments.length)return(e=this.tween(e))&&e._value;if(null==i)return this.tween(e,null);if("function"!=typeof i)throw new Error;return this.tween(e,He(a,i,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(be(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(1>arguments.length)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,Ye(e))},remove:function(){return this.on("end.remove",function(n){return function(){var t=this.parentNode;for(var a in this.__transition)if(+a!==n)return;t&&t.removeChild(this)}}(this._id))},tween:function(l,s){var n=this._id;if(l+="",2>arguments.length){for(var e,d=_e(this.node(),n).tween,i=0,p=d.length;i<p;++i)if((e=d[i]).name===l)return e.value;return null}return this.each((null==s?we:xe)(n,l,s))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Le:je)(t,e)):_e(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Xe:Oe)(t,e)):_e(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Ve(t,e)):_e(this.node(),t).ease},end:function(){var a,l,d=this,o=d._id,e=d.size();return new Promise(function(t,n){var r={value:n},p={value:function(){0==--e&&t()}};d.each(function(){var t=ye(this,o),e=t.on;e!==a&&((l=(a=e).copy())._.cancel.push(r),l._.interrupt.push(r),l._.end.push(p)),t.on=l})})}};var Ke={time:null,delay:0,duration:250,ease:function(e){return(1>=(e*=2)?e*e*e:(e-=2)*e*e+2)/2}};Et.prototype.interrupt=function(e){return this.each(function(){!function(l,t){var s,d,p,c=l.__transition,o=!0;if(c){for(p in t=null==t?null:t+"",c)(s=c[p]).name===t?(d=2<s.state&&5>s.state,s.state=6,s.timer.stop(),s.on.call(d?"interrupt":"cancel",l,l.__data__,s.index,s.group),delete c[p]):o=!1;o&&delete l.__transition}}(this,e)})},Et.prototype.transition=function(d){var p,c;d instanceof Be?(p=d._id,d=d._name):(p=Ge(),(c=Ke).time=qn(),d=null==d?null:d+"");for(var h=this._groups,r=h.length,i=0;i<r;++i)for(var g,m=h[i],u=m.length,s=0;s<u;++s)(g=m[s])&&de(g,d,p,s,m,c||Ze(g,p));return new Be(h,this._parents,d,p)};var Qe=en,We=2*Qe,tr=1e-6;Je.prototype=In.prototype={constructor:Je,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(a,t,n,e){this._+="Q"+ +a+","+ +t+","+(this._x1=+n)+","+(this._y1=+e)},bezierCurveTo:function(a,t,n,e,r,i){this._+="C"+ +a+","+ +t+","+ +n+","+ +e+","+(this._x1=+r)+","+(this._y1=+i)},arcTo:function(g,x,b,k,T){var C=Math.acos;g=+g,x=+x,b=+b,k=+k,T=+T;var S=this._x1,o=this._y1,a=b-g,u=k-x,s=S-g,l=o-x,c=s*s+l*l;if(0>T)throw new Error("negative radius: "+T);if(null===this._x1)this._+="M"+(this._x1=g)+","+(this._y1=x);else if(!(c>tr));else if(tn(l*a-u*s)>tr&&T){var h=b-S,f=k-o,p=a*a+u*u,d=ea(p),v=ea(c),m=T*N((Qe-C((p+c-(h*h+f*f))/(2*d*v)))/2),y=m/v,_=m/d;tn(y-1)>tr&&(this._+="L"+(g+y*s)+","+(x+y*l)),this._+="A"+T+","+T+",0,0,"+ +(l*h>s*f)+","+(this._x1=g+_*a)+","+(this._y1=x+_*u)}else this._+="L"+(this._x1=g)+","+(this._y1=x)},arc:function(d,p,g,m,r,i){var f=Math.sin,y=Math.cos;d=+d,p=+p,i=!!i;var _=(g=+g)*y(m),a=g*f(m),u=d+_,s=p+a,l=1^i,c=i?m-r:r-m;if(0>g)throw new Error("negative radius: "+g);null===this._x1?this._+="M"+u+","+s:(tn(this._x1-u)>tr||tn(this._y1-s)>tr)&&(this._+="L"+u+","+s),g&&(0>c&&(c=c%We+We),c>We-tr?this._+="A"+g+","+g+",0,1,"+l+","+(d-_)+","+(p-a)+"A"+g+","+g+",0,1,"+l+","+(this._x1=u)+","+(this._y1=s):c>tr&&(this._+="A"+g+","+g+",0,"+ +(c>=Qe)+","+l+","+(this._x1=d+g*y(r))+","+(this._y1=p+g*f(r))))},rect:function(a,t,n,e){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +e+"h"+-n+"Z"},toString:function(){return this._}};Vn.prototype=Un.prototype={constructor:Vn,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]==="$"&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]==="$"&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]==="$"&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]==="$"&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var a in this)a[0]==="$"&&++e;return e},empty:function(){for(var e in this)if(e[0]==="$")return!1;return!0},each:function(e){for(var t in this)t[0]==="$"&&e(this[t],t.slice(1),this)}};var nr=Un.prototype;Gn.prototype={constructor:Gn,has:nr.has,add:function(e){return this["$"+(e+="")]=e,this},remove:nr.remove,clear:nr.clear,values:nr.keys,size:nr.size,empty:nr.empty,each:nr.each};var lr,Qr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Ia.prototype=Va.prototype,Va.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":pa(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+pa(0,0|this.precision))+(this.trim?"~":"")+this.type};var pr,Jr,Wr={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return ra(e).toString(2)},c:function(e){return e+""},d:function(e){return 1e21<=tn(e=ra(e))?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return ra(e).toString(8)},p:function(e,t){return Ha(100*e,t)},r:Ha,s:function(l,t){var n=Xa(l,t);if(!n)return l+"";var e=n[0],r=n[1],i=r-(lr=3*pa(-8,da(8,aa(r/3))))+1,o=e.length;return i===o?e:i>o?e+Array(i-o+1).join("0"):0<i?e.slice(0,i)+"."+e.slice(i):"0."+Array(1-i).join("0")+Xa(l,pa(0,t+i-1))[0]},X:function(e){return ra(e).toString(16).toUpperCase()},x:function(e){return ra(e).toString(16)}},mr=Array.prototype.map,xr=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];Mr.format=void 0,pr=function(d){function p(s){function c(e){var n,r,p,c=D,u=O;if("c"===z)u=w(e)+u,e="";else{var h=0>(e=+e)||0>1/e;if(e=isNaN(e)?l:w(tn(e),A),N&&(e=function(a){t:for(var t,l=a.length,e=1,o=-1;e<l;++e)switch(a[e]){case".":o=t=e;break;case"0":0===o&&(o=e),t=e;break;default:if(!+a[e])break t;0<o&&(o=0);}return 0<o?a.slice(0,o)+a.slice(t+1):a}(e)),h&&0==+e&&"+"!==S&&(h=!1),c=(h?"("===S?S:_:"-"===S||"("===S?"":S)+c,u=("s"===z?xr[8+lr/3]:"")+u+(h&&"("===S?")":""),x)for(n=-1,r=e.length;++n<r;)if(48>(p=e.charCodeAt(n))||57<p){u=(46===p?o+e.slice(n+1):e.slice(n))+u,e=e.slice(0,n);break}}d&&!E&&(e=T(e,1/0));var g=c.length+e.length+u.length,m=g<P?Array(P-g+1).join(C):"";switch(d&&E&&(e=T(m+e,m.length?P-u.length:1/0),m=""),k){case"<":e=c+e+u+m;break;case"=":e=c+m+e+u;break;case"^":e=m.slice(0,g=m.length>>1)+c+e+u+m.slice(g);break;default:e=m+c+e+u;}return a(e)}var C=(s=Ia(s)).fill,k=s.align,S=s.sign,h=s.symbol,E=s.zero,P=s.width,d=s.comma,A=s.precision,N=s.trim,z=s.type;"n"===z?(d=!0,z="g"):Wr[z]||(void 0===A&&(A=12),N=!0,z="g"),(E||"0"===C&&"="===k)&&(E=!0,C="0",k="=");var D="$"===h?r:"#"===h&&/[boxX]/.test(z)?"0"+z.toLowerCase():"",O="$"===h?i:/[%p]/.test(z)?u:"",w=Wr[z],x=/[defgprs%]/.test(z);return A=void 0===A?6:/[gprs]/.test(z)?pa(1,da(21,A)):pa(0,da(20,A)),c.toString=function(){return s+""},c}var h,g,T=void 0===d.grouping||void 0===d.thousands?$a:(h=mr.call(d.grouping,Number),g=d.thousands+"",function(e,t){for(var n=e.length,r=[],l=0,o=h[0],d=0;0<n&&0<o&&(d+o+1>t&&(o=pa(1,t-d)),r.push(e.substring(n-=o,n+o)),!((d+=o+1)>t));)o=h[l=(l+1)%h.length];return r.reverse().join(g)}),r=void 0===d.currency?"":d.currency[0]+"",i=void 0===d.currency?"":d.currency[1]+"",o=void 0===d.decimal?".":d.decimal+"",a=void 0===d.numerals?$a:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(mr.call(d.numerals,String)),u=void 0===d.percent?"%":d.percent+"",_=void 0===d.minus?"-":d.minus+"",l=void 0===d.nan?"NaN":d.nan+"";return{format:p,formatPrefix:function(a,l){var n=p(((a=Ia(a)).type="f",a)),e=3*pa(-8,da(8,aa(qa(l)/3))),r=la(10,-e),i=xr[8+e/3];return function(e){return n(r*e)+i}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Mr.format=pr.format,Jr=pr.formatPrefix;var br=Array.prototype,Nr=br.map,Ar=br.slice,Er=[0,1];gr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,a){switch(e=+e,a=+a,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,a):this._context.moveTo(e,a);break;case 1:this._point=2;default:this._context.lineTo(e,a);}}},Mr.axisBottom=function(n){return e(3,n)},Mr.axisLeft=function(n){return e(4,n)},Mr.axisRight=function(n){return e(2,n)},Mr.bisector=n,Mr.curveLinear=yr,Mr.drag=function(){function x(e){e.on("mousedown.drag",b).filter(E).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(){if(!T&&C.apply(this,arguments)){var e=y("mouse",S.apply(this,arguments),zt,this,arguments);e&&(Lt(f.view).on("mousemove.drag",p,!0).on("mouseup.drag",d,!0),Dt(f.view),Mt(),k=!1,_=f.clientX,w=f.clientY,e("start"))}}function p(){if(Rt(),!k){var e=f.clientX-_,t=f.clientY-w;k=e*e+t*t>l}P.mouse("drag")}function d(){Lt(f.view).on("mousemove.drag mouseup.drag",null),function(a,t){var n=a.document.documentElement,e=Lt(a).on("dragstart.drag",null);t&&(e.on("click.drag",Rt,!0),setTimeout(function(){e.on("click.drag",null)},0)),"onselectstart"in n?e.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(f.view,k),Rt(),P.mouse("end")}function g(){if(C.apply(this,arguments)){var i,l,o=f.changedTouches,e=S.apply(this,arguments),r=o.length;for(i=0;i<r;++i)(l=y(o[i].identifier,e,Ot,this,arguments))&&(Mt(),l("start"))}}function v(){var a,i,l=f.changedTouches,e=l.length;for(a=0;a<e;++a)(i=P[l[a].identifier])&&(Rt(),i("drag"))}function m(){var a,r,l=f.changedTouches,e=l.length;for(T&&clearTimeout(T),T=setTimeout(function(){T=null},500),a=0;a<e;++a)(r=P[l[a].identifier])&&(Mt(),r("end"))}function y(c,t,n,e,r){var i,m,y,_=n(t,c),b=s.copy();if(kt(new Xt(x,"beforestart",i,c,N,_[0],_[1],0,0,b),function(){return null!=(f.subject=i=A.apply(e,r))&&(m=i.x-_[0]||0,y=i.y-_[1]||0,!0)}))return function o(a){var l,s=_;switch(a){case"start":P[c]=o,l=N++;break;case"end":delete P[c],--N;case"drag":_=n(t,c),l=N;}kt(new Xt(x,a,i,c,l,_[0]+m,_[1]+y,_[0]-s[0],_[1]-s[1],b),b.apply,b,[a,e,r])}}var _,w,k,T,C=It,S=Vt,A=Ht,E=$t,P={},s=ja("start","drag","end"),N=0,l=0;return x.filter=function(e){return arguments.length?(C="function"==typeof e?e:jt(!!e),x):C},x.container=function(e){return arguments.length?(S="function"==typeof e?e:jt(e),x):S},x.subject=function(e){return arguments.length?(A="function"==typeof e?e:jt(e),x):A},x.touchable=function(e){return arguments.length?(E="function"==typeof e?e:jt(!!e),x):E},x.on=function(){var e=s.on.apply(s,arguments);return e===s?x:e},x.clickDistance=function(e){return arguments.length?(l=(e=+e)*e,x):ea(l)},x},Mr.line=function(){function l(e){var t,n,a,r=e.length,i=!1;for(null==m&&(y=f(a=In())),t=0;t<=r;++t)!(t<r&&g(n=e[t],t,e))===i&&((i=!i)?y.lineStart():y.lineEnd()),i&&y.point(+d(n,t,e),+p(n,t,e));if(a)return y=null,a+""||null}var d=vr,p=kr,g=hr(!0),m=null,f=yr,y=null;return l.x=function(e){return arguments.length?(d="function"==typeof e?e:hr(+e),l):d},l.y=function(e){return arguments.length?(p="function"==typeof e?e:hr(+e),l):p},l.defined=function(e){return arguments.length?(g="function"==typeof e?e:hr(!!e),l):g},l.curve=function(e){return arguments.length?(f=e,null!=m&&(y=f(m)),l):f},l.context=function(e){return arguments.length?(null==e?m=y=null:y=f(m=e),l):m},l},Mr.mouse=zt,Mr.range=function(a,l,s){a=+a,l=+l,s=2>(p=arguments.length)?(l=a,a=0,1):3>p?1:+s;for(var d=-1,p=0|pa(0,na((l-a)/s)),c=Array(p);++d<p;)c[d]=a+d*s;return c},Mr.scaleLinear=function e(){var t=Wa(Ya,Ya);return t.copy=function(){return Qa(t,e())},Ba.apply(t,arguments),ar(t)},Mr.scaleLog=function e(){var t=ur(Ja()).domain([1,10]);return t.copy=function(){return Qa(t,e()).base(t.base())},Ba.apply(t,arguments),t},Mr.select=Lt,window.SkewT=function(e){function t(e){var t={131072:"surface",65536:"standard level",32768:"tropopause level",16384:"maximum wind level",8192:"significant temperature level",4096:"significant humidity level",2048:"significant wind level",1024:"beginning of missing temperature data",512:"end of missing temperature data",256:"beginning of missing humidity data",128:"end of missing humidity data",64:"beginning of missing wind data",32:"end of missing wind data",16:"top of wind sounding",8:"level determined by regional decision",4:"reserved",2:"pressure level vertical coordinate"},n=[];return function e(r,a){r%2&&n.push(t[1<<a]),r&&e(r>>1,a+1)}(e,0),n}function n(){E=parseInt(A.style("width"),10)-10,r=E-P.left-P.right,d=E-P.top-P.bottom,s=N((v||55)*z),p=Mr.scaleLinear().range([-r/2,r+r/2]).domain([0-2*X,0+2*X]),K=Mr.scaleLog().range([0,d]).domain([k,1050]),Q=Mr.axisBottom(p).tickSize(0,0).ticks(20),J=Mr.axisLeft(K).tickSize(0,0).tickValues($.filter(function(e){return 0==e%100||50==e||150==e})).tickFormat(Mr.format(".0d")),W=Mr.axisRight(K).tickSize(5,0).tickValues(B),ee=Mr.axisLeft(K).tickSize(2,0).tickValues(U)}function a(e,t){return"kt"===t?1.943844492*e:"kmh"===t?3.6*e:e}function l(e,t){return"m"===t?ra(e)+t:"f"===t?ra(3.28084*e)+"ft":e}function o(){ue.selectAll("*").remove(),n(),le.attr("width",r+P.right+P.left).attr("height",d+P.top+P.bottom),ce.attr("transform","translate("+P.left+","+P.top+")"),we(),ae.forEach(function(e){Ae(e.data,{add:!0,select:!1})}),u&&Se(u.data),ke(),fe.attr("width",r).attr("height",d),ie.style("left",P.left+2+"px").style("top",P.top+"px").style("height",d+"px");var e=K(100);ye.style("left","0px").style("top",e+"px").style("height",d-e+"px"),_e.style("left","10px").style("top",e+"px").style("height",d-e+"px")}for(var s,u,g=this,m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},f=m.isTouchDevice,_=m.gradient,v=void 0===_?45:_,b=m.topp,k=void 0===b?50:b,T=m.parctempShift,C=void 0===T?2:T,S=this,A=Mr.select(e),E=parseInt(A.style("width"),10),P={top:10,right:25,bottom:10,left:25},z=en/180,D=!1,O=1050,M=-50,R=0,X=60,q=0,I=ka(k)/30,V=!1,H=273.15,c=null,$=[1e3,950,925,900,850,800,700,600,500,400,300,250,200,150,100,50],B=[],F=25,Y=$[0]+F;Y>$[$.length-1];Y-=F)B.push(Y);for(var U=[],G=0;2e4>G;G+=1e4/3.28084)U.push(Ta(G));var Z=Mr.scaleLinear().range([0,300]).domain([0,150]);Mr.scaleLinear();var r,d,p,K,Q,J,W,ee,te=Mr.bisector(function(e){return e.press}).left,ne=[],ae=[],re="m";void 0===f&&(L&&L.version?L.Browser.mobile&&(f=!0):f="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints);var ie=A.append("div").attr("class","cloud-container"),le=A.append("svg").attr("class","mainsvg"),oe=A.append("div").attr("class","controls fnt"),se=A.append("div").attr("class","controls fnt"),de=A.append("div").attr("class","range-container fnt"),pe=A.append("div").attr("class","range-container-extra fnt"),ce=le.append("g"),ue=ce.append("g").attr("class","skewtbg"),he=ce.append("g").attr("class","skewt"),ge=ce.append("g").attr("class","windbarb"),me=ce.append("g").attr("class","tooltips"),fe=ce.append("rect").attr("class","overlay"),ye=ie.append("canvas").attr("width",1).attr("height",200).attr("class","cloud");this.cloudRef1=ye.node();var _e=ie.append("canvas").attr("width",1).attr("height",200).attr("class","cloud");this.cloudRef2=_e.node(),Mr.select(window).on("resize",o);var ve,xe,be={},we=function(){ve=ue.append("clipPath").attr("id","clipper").append("rect").attr("x",0).attr("y",0).attr("width",r).attr("height",d),be.temp=ue.selectAll("templine").data(Mr.scaleLinear().domain([R-3*X,R+X]).ticks(24)).enter().append("line").attr("x1",function(e){return p(e)-.5+(K(O)-K(k))/s}).attr("x2",function(e){return p(e)-.5}).attr("y1",0).attr("y2",d).attr("class",function(e){return 0==e?"tempzero ".concat(Le.Temp.hi?"highlight-line":""):"templine ".concat(Le.Temp.hi?"highlight-line":"")}).attr("clip-path","url(#clipper)");var e=V?[O,O-.25*(O-k),O-.5*(O-k),O-.75*(O-k),k]:Mr.range(O,k-50,M),n=Ta(11e3),a=Mr.line().curve(Mr.curveLinear).x(function(e){var a=e>n?15-.00649*ka(e):-56.5;return p(a)+(K(O)-K(e))/s}).y(function(e){return K(e)});be.elr=ue.selectAll("elr").data([$.filter(function(e){return e>n}).concat([n,50])]).enter().append("path").attr("d",a).attr("clip-path","url(#clipper)").attr("class","elr ".concat(qe?"highlight-line":"")),be.pressure=ue.selectAll("pressureline").data($).enter().append("line").attr("x1",-r).attr("x2",2*r).attr("y1",K).attr("y2",K).attr("clip-path","url(#clipper)").attr("class","pressure ".concat(Le.Pressure.hi?"highlight-line":""));for(var l,t=Mr.scaleLinear().domain([R-2*X,R+4*X]).ticks(36),o=[],c=0;c<t.length;c++){l=[];for(var u=0;u<e.length;u++)l.push(t[c]);o.push(l)}var h=Mr.line().curve(Mr.curveLinear).x(function(t,n){return p(fa(e[n],H+t,O)-H)+(K(O)-K(e[n]))/s}).y(function(t,n){return K(e[n])});be.dryadiabat=ue.selectAll("dryadiabatline").data(o).enter().append("path").attr("class","dryadiabat  ".concat(Le["Dry Adiabat"].hi?"highlight-line":"")).attr("clip-path","url(#clipper)").attr("d",h);var g,m=Mr.line().curve(Mr.curveLinear).x(function(t,n){return g=0==n?H+t:g+xa(e[n],g)*(V?(k-O)/4:M),p(g-H)+(K(O)-K(e[n]))/s}).y(function(t,n){return K(e[n])});be.moistadiabat=ue.selectAll("moistadiabatline").data(o).enter().append("path").attr("class","moistadiabat ".concat(Le["Moist Adiabat"].hi?"highlight-line":"")).attr("clip-path","url(#clipper)").attr("d",m);var f,y=Mr.line().curve(Mr.curveLinear).x(function(t,n){return 0==n&&(f=ya(va(t+H),e[n])),g=wa(ba(e[n],f)),p(g-H)+(K(O)-K(e[n]))/s}).y(function(t,n){return K(e[n])});be.isohume=ue.selectAll("isohumeline").data(o).enter().append("path").attr("class","isohume ".concat(Le.Isohume.hi?"highlight-line":"")).attr("clip-path","url(#clipper)").attr("d",y),ue.append("line").attr("x1",r-.5).attr("x2",r-.5).attr("y1",0).attr("y2",d).attr("class","gridline"),xe=ue.append("g").attr("class","x axis").attr("transform","translate(0,"+(d-.5)+")").call(Q).attr("clip-path","url(#clipper)"),ue.append("g").attr("class","y axis").attr("transform","translate(-0.5,0)").call(J),ue.append("g").attr("class","y axis ticks").attr("transform","translate(-0.5,0)").call(W),ue.append("g").attr("class","y axis hght-ticks").attr("transform","translate(-0.5,0)").call(ee)},ke=function(){for(var e in ve.attr("x",-q),xe.attr("transform","translate(".concat(q,", ").concat(d-.5," )")),be)be[e].attr("transform","translate(".concat(q,",0)"));ae.forEach(function(e){for(var t in e.lines)e.lines[t].attr("transform","translate(".concat(q,",0)"))})},Te=function(){function e(){[u,h,g,_].forEach(function(t){return t.style("display",null)}),i.call(fe.node()),k=Mr.mouse(this)[0]-q}function n(){k=null}function i(){var e=Mr.mouse(this)[0];null!==k&&(q=-(k-e),ke());var t=K.invert(Mr.mouse(this)[1]);T(t)}var o=this,u=me.append("g").attr("class","focus tmpc").style("display","none");u.append("circle").attr("r",4),u.append("text").attr("x",9).attr("dy",".35em");var h=me.append("g").attr("class","focus dwpc").style("display","none");h.append("circle").attr("r",4),h.append("text").attr("x",-9).attr("text-anchor","end").attr("dy",".35em");var g=me.append("g").attr("class","focus").style("display","none"),m=g.append("text").attr("x","0.8em").attr("text-anchor","start").attr("dy",".35em"),y=g.append("text").attr("x","0.8em").attr("text-anchor","start").attr("dy","-0.65em").style("fill","blue"),_=me.append("g").attr("class","focus windspeed").style("display","none"),v=_.append("text").attr("x","0.8em").attr("text-anchor","start").attr("dy",".35em"),x=_.append("text").attr("x","0.8em").attr("text-anchor","start").attr("dy","-0.65em").style("fill","red"),b=_.append("text").attr("class","skewt-wind-arrow").html("&#8681;"),w=_.append("text").attr("y","1em").attr("text-anchor","start").style("fill","rgba(0,0,0,0.3)").style("font-size","10px"),k=null,T=function(e){var n=te(ne,e,1,ne.length-1),i=ne[n-1],f=ne[n],k=e-i.press>f.press-e?f:i;c=e,u.attr("transform","translate("+(q+p(k.temp)+(K(O)-K(k.press))/s)+","+K(k.press)+")"),h.attr("transform","translate("+(q+p(k.dwpt)+(K(O)-K(k.press))/s)+","+K(k.press)+")"),g.attr("transform","translate(0,"+K(k.press)+")"),m.html("&nbsp;&nbsp;&nbsp;"+l(k.hght,re)),y.html("&nbsp;&nbsp;&nbsp;"+ra(k.dwpt)+"&#176;C"),_.attr("transform","translate("+(r-60)+","+K(k.press)+")"),v.html(isNaN(k.wspd)?"":ra(10*a(k.wspd))/10+" "+"kt"),x.html(ra(k.temp)+"&#176;C"),b.style("transform","rotate(".concat(k.wdir,"deg)")),w.html(k.flags?t(k.flags).map(function(e){return"<tspan x=\"-8em\" dy=\"0.8em\">".concat(e,"</tspan>")}).join():""),o.cbf&&o.cbf(k.press)};fe.attr("width",r).attr("height",d),f?fe.on("touchstart",e).on("touchmove",i).on("touchend",n):fe.call(Mr.drag().on("start",e).on("drag",i).on("end",n)),Object.assign(this,{move2P:T,hideTooltips:function(){[u,h,g,_].forEach(function(t){return t.style("display","none")}),c=null},showTooltips:function(){[u,h,g,_].forEach(function(t){return t.style("display",null)})}})},Ce=function(e){var t=e.data,n=e.parctemp,a=Ca({level:t.map(function(t){return t.press}),gh:t.map(function(t){return t.hght}),temp:t.map(function(t){return t.temp+H})},V?10:40,n+H,t[0].press,t[0].dwpt+H),r=Mr.line().curve(Mr.curveLinear).x(function(e){return p(e.t)+(K(O)-K(e.p))/s}).y(function(e){return K(e.p)}),i={parcel:[],LCL:[],CCL:[],TCON:[],"THRM top":[],"CLD top":[]};for(var o in i){e.lines[o]&&e.lines[o].remove();var d=[],c=void 0;switch(o){case"parcel":a.dry&&d.push(a.dry),a.moist&&d.push(a.moist);break;case"TCON":var h=a.TCON;d=void 0===h?[]:[[[h,O],[h,k]]];break;case"LCL":a.isohumeToDry&&d.push(a.isohumeToDry);break;case"CCL":a.isohumeToTemp&&d.push(a.isohumeToTemp),a.moistFromCCL&&d.push(a.moistFromCCL);break;case"THRM top":c=a.pThermalTop,c&&(d=[[[0,c],[400,c]]]);break;case"CLD top":c=a.pCloudTop,c&&(d=[[[0,c],[400,c]]]);}d&&(i[o]=d.map(function(t){return t.map(function(e){return{t:e[0]-H,p:e[1]}})})),e.lines[o]=he.selectAll(o).data(i[o]).enter().append("path").attr("class","".concat("parcel"==o?"parcel":"cond-level"," ").concat(u&&t==u.data&&("parcel"==o||Ne[o].hi)?"highlight-line":"")).attr("clip-path","url(#clipper)").attr("d",r).attr("transform","translate(".concat(q,",0)"))}for(var g in Ne){var m=a["CLD top"==g?"cloudTop":"THRM top"==g?"elevThermalTop":g],f=void 0;"CLD top"==g&&1e5==m&&(m=t[t.length-1].hght,f=!0);var y="".concat((g[0].toUpperCase()+g.slice(1)).replace(" ","&nbsp;"),":<br><span style=\"font-size:1.1em;\"> ").concat(m?"TCON"==g?(m-H).toFixed(1)+"&#176;C":(f?"> ":"")+l(m,re):"","</span>");Ne[g].val.html(y)}},Se=function(e){ae.forEach(function(t){var n=t.data==e;for(var a in t.lines)t.lines[a].classed("highlight-line",n&&(!Ne[a]||Ne[a].hi));n&&(u=t,ne=[].concat(t.data).reverse(),Oe.parctemp.input.node().value=Oe.parctemp.value=t.parctemp=ra(10*t.parctemp)/10,Oe.parctemp.valueDiv.html(Re(t.parctemp,"parctemp")))}),S.hideTooltips()},Ae=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=n.add,l=n.select,o=n.ixShift,c=void 0===o?0:o,u=n.max,h=void 0===u?2:u;if(0!=e.length){var g=0;i||(ae.forEach(function(e){for(var t in e.lines)e.lines[t].remove()}),ae=[],[1,2].forEach(function(e){var t=S["cloudRef"+e].getContext("2d");t.clearRect(0,0,10,200)}));var d,m=ae.find(function(t){return t.data==e});if(!m){var f=ra(10*(e[0].temp+Oe.parctempShift.value))/10;d=e,g=ae.push({data:d,parctemp:f,lines:{}})-1,m=ae[g],g>=h&&(console.log("more than max plots added"),g--,setTimeout(function(e){ae.length>h&&S.removePlot(ae[e].data)},1e3,g))}else for(var y in g=ae.indexOf(m),d=m.data,m.lines)m.lines[y].remove();l&&(Oe.parctemp.input.node().value=Oe.parctemp.value=m.parctemp,Oe.parctemp.valueDiv.html(Re(m.parctemp,"parctemp")));var _=d.filter(function(e){return-1e3<e.temp&&-1e3<e.dwpt}),v=[_];if(50<d.length&&V){var x=-1;v=[_.filter(function(t,e,r){var a=aa(50*e/(r.length-1));if(a>x)return x=a,!0})]}var b=Mr.line().curve(Mr.curveLinear).x(function(e){return p(e.temp)+(K(O)-K(e.press))/s}).y(function(e){return K(e.press)});if(m.lines.tempLine=he.selectAll("templines").data(v).enter().append("path").attr("class","temp").attr("clip-path","url(#clipper)").attr("d",b),d[0].dwpt){var w=Mr.line().curve(Mr.curveLinear).x(function(e){return p(e.dwpt)+(K(O)-K(e.press))/s}).y(function(e){return K(e.press)});m.lines.tempdewLine=he.selectAll("tempdewlines").data(v).enter().append("path").attr("class","dwpt").attr("clip-path","url(#clipper)").attr("d",w),Ce(m)}var T=d.filter(function(e,n,r,a){return!!(e.flags&&(a=t(e.flags),a.includes("tropopause level")||a.includes("surface")))&&e.press}).map(function(e,n,r,a){return a=t(e.flags),{press:e.press,classes:a.map(function(t){return t.replace(/ /g,"-")}).join(" ")}});m.lines.siglines=ue.selectAll("siglines").data(T).enter().append("line").attr("x1",-r).attr("x2",2*r).attr("y1",function(e){return K(e.press)}).attr("y2",function(e){return K(e.press)}).attr("clip-path","url(#clipper)").attr("class",function(e){return"sigline ".concat(e.classes)});var C=-300,A=v[0].filter(function(e){return e.hght>C+I&&(e.wspd||0===e.wspd)&&e.press>=k&&(C=e.hght),e.hght==C});m.lines.barbs=ge.append("svg").attr("class","barblines"),m.lines.barbs.selectAll("barbs").data(A).enter().append("use").attr("href",function(e){return"#barb"+5*ra(a(e.wspd,"kt")/5)}).attr("transform",function(e){return"translate("+(r+15*(g+c))+","+K(e.press)+") rotate("+(e.wdir+180)+")"});var E=Or.computeClouds(d);return E.canvas=S["cloudRef"+(g+c+1)],Or.cloudsToCanvas(E),(l||1==ae.length)&&Se(m.data),ke(),ae.length}},Le={"Dry Adiabat":{},"Moist Adiabat":{},Isohume:{},Temp:{},Pressure:{}},Ee=function(e){var t=e,n=Le[t];n.hi=!1,n.el=oe.append("div").attr("class","buttons").text(t).on("click",function(){n.hi=!n.hi,n.el.node().classList[n.hi?"add":"remove"]("clicked");var e=t.replace(" ","").toLowerCase();be[e]._groups[0].forEach(function(e){return e.classList[n.hi?"add":"remove"]("highlight-line")})})};for(var Pe in Le)Ee(Pe);var Ne={surface:{},LCL:{hi:!0},CCL:{hi:!0},TCON:{hi:!1},"THRM top":{hi:!1},"CLD top":{hi:!1}},ze=function(e){var t=e,n=Ne[t];n.val=se.append("div").attr("class","buttons ".concat("surface"==t?"noclick":""," ").concat(n.hi?"clicked":"")).html(t+":"),/CCL|LCL|TCON|THRM top|CLD top/.test(t)&&n.val.on("click",function(){n.hi=!n.hi,n.val.node().classList[n.hi?"add":"remove"]("clicked"),u.lines[t]._groups[0].forEach(function(e){return e.classList[n.hi?"add":"remove"]("highlight-line")})})};for(var De in Ne)ze(De);var Oe={parctemp:{value:10,step:.1,min:-50,max:50},topp:{min:50,max:900,step:25,value:k},parctempShift:{min:-5,step:.1,max:10,value:C},gradient:{min:0,max:85,step:1,value:v}},Me=function(e){return"gradient"==e?"&#176":"topp"==e?"hPa":"&#176;C"},Re=function(e,t){var n="";if("parctempShift"==t&&0<=Z.value&&(n+="+"),n+=("gradient"==t||"topp"==t?ra(e):ra(10*e)/10)+Me(t),"parctemp"==t){var a=u?ra(10*(e-u.data[0].temp))/10:C;n+=" <span style='font-size:0.8em'>&nbsp;"+(0<a?"+":"")+a+"</span>"}return n},je=function(e){var t=e,a="parctemp"==t||"topp"==t?de:pe,i=Oe[t];i.valueDiv=a.append("div").attr("class","skewt-range-des").html("gradient"==t?"Gradient:":"topp"==t?"Top P:":"parctemp"==t?"Parcel T:":"Parcel T Shift:"),i.valueDiv=a.append("div").attr("class","skewt-range-val").html(Re(i.value,t)),i.input=a.append("input").attr("type","range").attr("min",i.min).attr("max",i.max).attr("step",i.step).attr("value","gradient"==t?90-i.value:i.value).attr("class","skewt-ranges").on("input",function(e,a,r){if(S.hideTooltips(),i.value=+r[0].value,"gradient"==t&&(v=i.value=90-i.value,Ie(0,0,i.input)),"topp"==t){Ie(0,0,i.input);var l=K(O)-K(k);k=i.value;var s=K(O)-K(k);M=500<k?-25:-50,D?(Oe.gradient.value=v=nn(N(v*z)*l/s)/z,Oe.gradient.input.node().value=90-v,Oe.gradient.valueDiv.html(Re(v,"gradient"))):(X*=s/l,n()),I=ka(k)/30}"parctempShift"==t&&(C=i.value),i.valueDiv.html(Re(i.value,t)),clearTimeout(V),V=setTimeout(function(){V=!1,"parctemp"==t?Ce(u):o()},1e3),"parctemp"==t?(u.parctemp=i.value,Ce(u)):o(),g.cbfRange({topp:k,gradient:v,parctempShift:C})}),a.append("div").attr("class","flex-break")};for(var Xe in Oe)je(Xe);var qe,Ie=function(e,t,n){n=n[0]||n.node(),be.elr.classed("highlight-line",!0),clearTimeout(qe),qe=null,qe=setTimeout(function(){n.blur(),be.elr.classed("highlight-line",qe=null)},1e3)};Oe.gradient.input.on("focus",Ie),Oe.topp.input.on("focus",Ie);var Ve=pe.append("span").attr("class","checkbox-container");Ve.append("input").attr("type","checkbox").on("click",function(t,n,a){D=a[0].checked}),Ve.append("span").attr("class","skewt-checkbox-text").html("Maintain temp range on X-axis when zooming"),pe.append("span").attr("class","skewt-checkbox-text").style("line-height","22px").html("Select alt units: ");var He={meter:{},feet:{}},$e=function(e){var t=e;He[t].hi=t[0]==re,He[t].el=pe.append("div").attr("class","buttons units"+(re==t[0]?" clicked":"")).text(t).on("click",function(){for(var e in He){var n=e;He[n].hi=t==n,He[n].el.node().classList[He[n].hi?"add":"remove"]("clicked")}re=t[0],null!==c&&S.move2P(c),Ce(u)})};for(var Be in He)$e(Be);var Fe=function(e){var t=ae.find(function(t){return t.data==e});if(t){for(var n in t.lines)t.lines[n].remove();ae.splice(ae.indexOf(t),1)}},Ye=function(){ae.forEach(function(e){for(var t in e.lines)e.lines[t].remove()}),he.selectAll("lines").remove(),he.selectAll("path").remove(),he.selectAll("g").remove(),ge.selectAll("use").remove(),ae=[]};this.drawBackground=we,this.resize=o,this.plot=Ae,this.clear=Ye,this.clearBg=function(){ue.selectAll("*").remove()},this.selectSkewt=Se,this.removePlot=Fe,this.cbf=function(){},this.cbfRange=function(){},this.setCallback=function(e){g.cbf=e},this.setCallbackRange=function(e){g.cbfRange=e},this.refs={},this.refs.tooltipRect=fe.node(),n(),o(),Te.call(this),function(){var e=Mr.range(5,205,5),t=ce.append("defs");e.forEach(function(e){var n=t.append("g").attr("id","barb"+e),a=aa(e/50),r=aa((e-50*a)/10),l=aa((e-50*a-10*r)/5),o=15/2;n.append("line").attr("x1",0).attr("x2",0).attr("y1",-15/2).attr("y2",15/2);for(var s=0;s<a;s++)n.append("polyline").attr("points","0,"+o+" -6,"+o+" 0,"+(o-2)).attr("class","flag"),o-=5;for(s=0;s<r;s++)n.append("line").attr("x1",0).attr("x2",-6).attr("y1",o).attr("y2",o+2),o-=3;for(s=0;s<l;s++)n.append("line").attr("x1",0).attr("x2",-3).attr("y1",o).attr("y2",o+1),o-=3})}()}})();